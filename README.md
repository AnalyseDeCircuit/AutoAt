# AutoAt 插件

这是一个自动回at的AstrBot插件，支持监控指定群聊中特定用户的at消息并自动回复。

## 功能特性

- 🎯 **精确监控**：监控指定群聊中特定用户的at消息
- 🤖 **自动回复**：检测到at后自动引用回复并at回该用户
- 👑 **权限管理**：内置管理员白名单系统，保护插件配置安全
- ⚙️ **灵活配置**：支持多群聊、多用户监控配置
- 💬 **自定义回复**：可选择是否启用自定义回复消息
- 📝 **简化配置**：友好的配置格式，无需复杂JSON编写

## 配置说明

### 基本配置

- **我的QQ号** (`my_qq`): 自己的QQ号，用于判断是否被at
- **管理员白名单** (`admin_whitelist`): 逗号分隔的QQ号列表，只有白名单用户可以执行管理命令
- **启用自定义回复消息** (`enable_reply_message`): 是否在回复时添加文字内容
- **自定义回复消息** (`reply_message`): 回复时发送的文字内容（仅在启用时生效）

### 监控配置

`monitor_config` 使用简化的文本格式，每行配置一个群聊：

**格式：** `群号:用户1,用户2,用户3`

**示例：**
- `87654321:111111111,222222222 `
- `123456789:333333333 `
- `55666777:444555666,777888999,123123123`


这表示：
- 在群聊 `987654321` 中监控用户 `111111111` 和 `222222222`
- 在群聊 `123456789` 中监控用户 `333333333`  
- 在群聊 `555666777` 中监控用户 `444555666`、`777888999` 和 `123123123`

### 管理员配置

`admin_whitelist` 使用逗号分隔的格式：

**格式：** `QQ号1,QQ号2,QQ号3`

**示例：** `123456789,987654321,555666777`

## 管理命令

插件提供以下管理命令（仅管理员可用）：

| 命令 | 别名 | 功能 | 示例 |
|------|------|------|------|
| `/autoat 状态` | `status`, `info` | 查看插件配置和运行状态 | `/autoat 状态` |
| `/autoat 测试` | `test` | 测试插件是否正常运行 | `/autoat 测试` |
| `/autoat 添加管理员` | `add_admin` | 添加新的管理员 | `/autoat 添加管理员 123456789` |
| `/autoat 移除管理员` | `remove_admin` | 移除现有管理员 | `/autoat 移除管理员 123456789` |

## 安装和使用

1. **安装插件**：将插件文件放入AstrBot的`plugins`目录
2. **配置插件**：在AstrBot Web管理界面中配置相关参数
3. **重启AstrBot**：让配置生效
4. **测试功能**：使用 `/autoat 测试` 命令验证插件是否正常工作

## 配置示例

### 简单配置
我的QQ号: `123456789` 

管理员白名单: `123456789` 

监控配置: `987654321:111111111` 

启用自定义回复消息: `false`

### 复杂配置
我的QQ号: `123456789 `

管理员白名单: `123456789,987654321,555666777 `

监控配置: `987654321:111111111,222222222 123456789:333333333 555666777:444555666,777888999 `

启用自定义回复消息: `true `

自定义回复消息: `收到您的消息！`

## 工作原理

1. 插件监控指定群聊中特定用户的消息
2. 检测消息中是否包含对机器人的at
3. 如果检测到at，自动发送回复消息并at原发送者
4. 支持可选的自定义文字回复内容

## 权限系统

- **普通用户**：无法执行任何管理命令
- **管理员**：可以查看状态、测试插件、管理其他管理员
- **自动回at功能**：对所有配置的目标用户生效，无需额外权限

## 配置说明详解

### 监控配置语法

- **单群单用户**：`987654321:111111111`
- **单群多用户**：`987654321:111111111,222222222,333333333`
- **多群配置**：每行写一个群聊配置，支持无限群聊数量
- **用户分隔**：同一群聊的多个用户用英文逗号 `,` 分隔
- **群聊分隔**：不同群聊的配置用换行分隔

### 错误处理

- 格式错误的配置行会被自动忽略并记录警告
- 如果所有配置都无效，会使用默认配置
- 空的群号或用户列表会被忽略
- 重复的用户配置不会造成问题

## 注意事项

- 管理员权限修改需要重启插件才能永久生效
- 监控配置支持多个群聊和多个用户的复杂组合
- 配置格式简单，但请注意冒号和逗号的使用
- 建议至少保留一个管理员账号，避免失去插件控制权
- QQ号建议使用字符串格式避免数字溢出问题

## 常见问题

**Q: 配置了监控但没有自动回复？**

A: 请检查机器人QQ号是否正确，确认被at的消息是否来自配置的目标用户

**Q: 管理命令提示权限不足？**

A: 请确认您的QQ号在管理员白名单中，并且插件已重启生效

**Q: 如何监控所有群聊中的某个用户？**

A: 需要在每个群聊配置中都添加该用户，例如：
群聊1:目标用户 群聊2:目标用户

## 支持

如有问题或建议，请访问 [AstrBot帮助文档](https://astrbot.app)

## 更新日志

- **v1.0.0**: 初始版本，支持基本的自动回at功能
- 简化配置格式，提升用户体验
- 添加管理员权限系统
- 支持多群聊、多用户监控

## 开源协议

本插件遵循开源协议，欢迎贡献代码和反馈问题。